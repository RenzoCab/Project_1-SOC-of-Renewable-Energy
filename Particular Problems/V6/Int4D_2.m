function [X] = Int4D_2(p,f)

    % p=[p1,p2,p3,p4] are the coordinates of the interpoled point.
    % f=[f1,f2,...,f16] are the evaluations in the corners of the square.
    
    [w,x,y,z] = ndgrid((0:1));
    [w1,x1,y1,z1] = ndgrid([0,p(1),1],[0,p(2),1],[0,p(3),1],[0,p(4),1]);
    ff = @(w,x,y,z) (w==0 & x==0 & y==0 & z==0)*f(1) +...
        (w==1 & x==0 & y==0 & z==0)*f(2) +...
        (w==0 & x==1 & y==0 & z==0)*f(3) +...
        (w==1 & x==1 & y==0 & z==0)*f(4) +...
        (w==0 & x==0 & y==1 & z==0)*f(5) +...
        (w==1 & x==0 & y==1 & z==0)*f(6) +...
        (w==0 & x==1 & y==1 & z==0)*f(7) +...
        (w==1 & x==1 & y==1 & z==0)*f(8) +...
        (w==0 & x==0 & y==0 & z==1)*f(9) +...
        (w==1 & x==0 & y==0 & z==1)*f(10) +...
        (w==0 & x==1 & y==0 & z==1)*f(11) +...
        (w==1 & x==1 & y==0 & z==1)*f(12) +...
        (w==0 & x==0 & y==1 & z==1)*f(13) +...
        (w==1 & x==0 & y==1 & z==1)*f(14) +...
        (w==0 & x==1 & y==1 & z==1)*f(15) +...
        (w==1 & x==1 & y==1 & z==1)*f(16);
    v = ff(w,x,y,z);
    Vq = interpn(w,x,y,z,v,w1,x1,y1,z1,'makima');
    X = Vq(2,2,2,2);

end

% For testing:
% 
% for i=0:1000
% a(i+1)=Int4D_2([(i/1000)^3 (i/1000)^5 (i/1000)^2 (i/1000)^(1/2)],[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16])
% end
% plot(1:1001,a)