close all;
clear all;
clc;

Power1 = [8000
10000
12000
14000
16000
18000
20000
22000
24000
26000
28000
30000
32000
34000
36000
38000
40000
42000
44000
46000
48000
50000
52000
54000
56000
58000
60000
62000
64000
66000
68000
70000
72000
74000
76000
78000
80000
82000
84000
86000
88000
90000
92000
94000
96000
98000
100000
102000
104000
106000
108000
110000
112000
114000
116000
118000
120000
122000
124000
126000
128000
130000
132000
134000
136000
138000
140000
142000
144000
146000
148000
150000
152000
152712];
Level1 = [16	16.25	16.5	16.75	17	17.25	17.5	17.75	18	18.25	18.5	18.75	19	19.25	19.5	19.75	20	20.25	20.5	20.75	21	21.25	21.5	21.75	22	22.25	22.5	22.75	23	23.25	23.5	23.75	24	24.25	24.5	24.75	25	25.25	25.5	25.75	26	26.25	26.5	26.75	27	27.25	27.5	27.75	28];
Flows1 = [63	62	61	61	60	59	58	57	56	55	55	54	53	52	52	51	50	50	49	48	48	47	47	46	46	45	45	44	44	43	43	42	42	41	41	40	40	40	39	39	38	38	38	37	37	36	36	35	35
77	75	74	73	72	71	70	69	68	67	66	65	64	63	63	62	61	60	60	59	58	57	57	56	55	55	54	54	53	52	52	51	51	50	50	49	49	48	48	47	47	46	45	45	44	44	43	43	42
90	89	88	86	85	84	82	81	80	79	78	77	76	75	74	73	72	71	70	69	68	68	67	66	65	65	64	63	62	62	61	60	60	59	58	58	57	56	56	55	55	54	53	53	52	52	51	50	50
104	102	101	99	98	96	95	93	92	91	89	88	87	86	85	84	83	82	81	80	79	78	77	76	75	74	73	72	72	71	70	69	69	68	67	66	66	65	64	63	63	62	61	61	60	59	59	58	57
118	116	114	112	110	109	107	106	104	103	101	100	99	97	96	95	94	92	91	90	89	88	87	86	85	84	83	82	81	80	79	78	77	76	76	75	74	73	72	72	71	70	69	69	68	67	66	66	65
131	129	127	125	123	122	120	118	116	115	113	112	110	109	107	106	105	103	102	101	99	98	97	96	95	93	92	91	90	89	88	87	86	85	84	83	83	82	81	80	79	78	78	77	76	75	74	74	73
145	143	141	139	137	135	133	131	129	127	125	124	122	120	119	117	116	114	113	111	110	108	107	106	105	103	102	101	100	99	97	96	95	94	93	92	91	90	89	88	88	87	86	85	84	83	83	82	81
159	157	155	152	150	148	146	144	142	140	138	136	134	132	130	129	127	125	124	122	121	119	118	116	115	113	112	111	109	108	107	106	105	103	102	101	100	99	98	97	96	95	94	93	93	92	91	90	89
181	178	175	172	165	162	160	157	155	153	150	148	146	144	142	140	138	137	135	133	131	130	128	127	125	124	122	121	119	118	117	115	114	113	112	110	109	108	107	106	105	104	103	102	101	100	99	98	97
194	191	188	185	182	180	177	174	168	166	163	161	159	156	154	152	150	148	146	144	142	141	139	137	136	134	132	131	129	128	126	125	124	122	121	120	118	117	116	115	114	113	112	111	110	109	108	107	106
208	205	201	198	195	192	189	187	184	181	179	176	172	169	167	164	162	160	158	156	154	152	150	148	146	144	143	141	139	138	136	135	133	132	130	129	128	126	125	124	123	121	120	119	118	117	116	115	114
222	218	215	211	208	205	202	199	196	193	191	188	186	183	181	178	174	172	169	167	165	163	161	159	157	155	153	151	150	148	146	145	143	142	140	139	137	136	134	133	132	130	129	128	127	126	125	124	122
235	231	228	224	221	218	214	211	208	205	203	200	197	194	192	189	187	185	182	180	176	174	172	170	168	166	164	162	160	158	156	155	153	151	150	148	147	145	144	142	141	139	138	137	136	134	133	132	130
249	245	241	237	234	230	227	224	221	218	215	212	209	206	203	201	198	195	193	191	188	186	184	182	179	177	175	173	170	168	166	165	163	161	159	158	156	154	153	151	150	148	147	145	144	142	141	139	138
262	258	254	250	247	243	240	236	233	230	227	223	220	217	215	212	209	206	204	201	199	196	194	192	189	187	185	183	181	178	176	174	173	171	169	167	165	163	162	160	158	157	155	153	152	150	149	147	146
276	272	268	264	260	256	252	249	245	242	239	235	232	229	226	223	220	217	215	212	209	207	204	202	199	197	194	192	190	188	186	184	182	180	178	176	174	172	170	168	167	165	163	162	160	159	157	155	154
290	285	281	277	273	269	265	262	258	254	251	247	244	241	238	234	231	228	225	223	220	217	214	212	209	207	204	202	199	197	195	193	191	189	187	185	183	181	179	177	175	173	172	170	168	167	165	164	162
304	299	295	291	287	283	279	275	271	267	263	260	256	253	249	246	243	239	236	233	230	227	225	222	219	217	214	212	209	207	204	202	200	198	196	193	191	189	188	186	184	182	180	178	177	175	173	172	170
319	314	309	305	300	296	292	288	284	280	276	272	268	264	261	257	254	251	247	244	241	238	235	232	229	227	224	221	219	216	214	211	209	207	205	202	200	198	196	194	192	190	189	187	185	183	182	180	178
339	330	325	320	315	310	305	301	297	292	288	284	280	276	273	269	265	262	258	255	252	249	246	243	240	237	234	231	229	226	223	221	219	216	214	212	209	207	205	203	201	199	197	195	193	192	190	188	187
353	347	342	334	329	324	319	314	310	305	301	297	292	288	284	281	277	273	270	266	263	259	256	253	250	247	244	241	239	236	233	231	228	226	223	221	218	216	214	212	210	208	206	204	202	200	198	197	195
366	360	355	349	343	338	333	328	323	318	314	309	305	301	297	292	289	285	281	277	274	270	267	264	260	257	254	251	248	246	243	240	237	235	232	230	228	225	223	221	219	216	214	212	210	209	207	205	203
380	374	368	363	357	352	347	342	337	332	327	322	317	313	309	304	300	296	292	289	285	281	278	274	271	268	265	262	258	256	253	250	247	244	242	239	237	234	232	230	227	225	223	221	219	217	215	213	211
393	387	381	376	370	365	360	355	349	345	340	335	330	326	321	316	312	308	304	300	296	292	289	285	282	278	275	272	269	266	263	260	257	254	251	249	246	244	241	239	236	234	232	230	228	226	223	221	219
407	401	395	389	383	378	372	367	362	357	352	347	342	338	333	329	324	320	315	311	307	303	300	296	292	289	285	282	279	276	273	270	267	264	261	258	255	253	250	248	245	243	241	238	236	234	231	229	227
420	414	408	402	397	391	385	380	374	369	364	359	354	349	345	340	336	331	327	323	319	315	311	307	303	299	296	293	289	286	283	279	276	273	270	268	265	262	259	257	254	252	249	247	244	242	239	237	235
434	428	422	416	410	404	398	392	387	382	376	371	366	361	356	352	347	342	338	334	330	326	321	318	314	310	306	303	299	296	292	289	286	283	280	277	274	271	268	265	263	260	257	255	252	250	247	245	243
449	442	436	430	423	417	411	405	400	394	389	383	378	373	368	363	358	354	349	345	340	336	332	328	324	320	316	312	309	305	302	298	295	292	289	285	283	280	277	274	271	269	266	263	261	258	256	253	251
463	456	450	444	437	431	424	418	412	407	401	395	390	385	380	374	370	365	360	355	351	347	342	338	334	330	326	322	318	315	311	308	304	301	298	294	291	288	286	283	280	277	274	271	269	266	264	261	259
478	471	464	458	451	444	438	431	425	419	413	408	402	397	391	386	381	376	371	366	362	357	353	348	344	340	336	332	328	324	321	317	314	310	307	303	300	297	294	291	288	286	283	280	277	275	272	270	267
494	487	479	472	465	458	451	445	438	432	426	420	414	409	403	398	392	387	382	377	372	368	363	359	354	350	346	342	338	334	330	326	323	319	316	313	309	306	303	300	297	294	291	288	286	283	281	278	276
511	503	495	488	479	472	465	458	451	445	439	433	427	421	415	409	404	398	393	388	383	378	374	369	365	360	356	352	348	344	340	336	332	329	325	322	318	315	312	309	306	303	300	297	294	291	289	286	284
524	516	508	501	493	486	479	471	465	458	451	445	439	433	427	421	415	410	405	399	394	389	384	380	375	371	366	362	358	354	350	346	342	338	335	331	328	324	321	318	315	311	308	306	303	300	297	295	292
538	530	522	514	507	499	492	485	478	471	464	458	451	445	439	433	427	421	416	410	405	400	395	390	386	381	376	372	368	364	359	355	352	348	344	340	337	333	330	327	323	320	317	314	311	308	306	303	300
551	543	535	528	520	512	505	498	491	484	477	470	464	457	451	445	439	433	427	422	416	411	406	401	396	391	387	382	378	373	369	365	361	357	353	350	346	342	339	336	332	329	326	323	320	317	314	311	308
565	557	549	541	533	526	518	511	503	496	489	483	476	470	463	457	450	444	438	433	427	422	417	412	407	402	397	392	388	383	379	375	371	367	363	359	355	352	348	345	341	338	335	332	328	325	322	319	316
579	571	562	555	547	539	531	523	516	509	502	495	488	482	475	469	462	456	450	444	438	433	427	422	417	412	407	403	398	393	389	385	381	377	372	369	365	361	357	354	350	347	343	340	337	333	330	327	324
593	585	576	568	560	552	544	536	529	521	514	507	500	493	487	480	474	468	461	455	450	444	438	433	428	423	418	413	408	403	399	394	390	386	382	378	374	370	366	362	359	355	352	348	345	342	338	335	332
608	599	590	582	574	565	557	549	541	534	526	519	512	505	498	492	485	479	473	467	461	455	449	444	438	433	428	423	418	413	409	404	399	395	391	387	383	379	375	371	367	364	360	357	353	350	347	343	340
623	613	604	596	587	579	570	562	554	546	539	531	524	517	510	503	497	490	484	478	471	466	460	454	449	443	438	433	428	423	418	413	409	404	400	396	392	388	384	380	376	372	369	365	362	358	355	352	348
638	628	619	610	601	592	584	575	567	559	551	544	536	529	522	515	508	501	495	488	482	476	470	464	459	453	448	443	438	433	428	423	418	414	409	405	400	396	392	388	385	381	377	373	370	366	363	360	357
654	644	634	624	615	606	597	588	580	572	564	556	548	541	533	526	519	512	506	499	493	487	481	475	469	463	458	453	447	442	437	432	427	423	418	414	409	405	401	397	393	389	386	382	378	375	371	368	365
670	659	649	639	629	620	611	602	593	585	576	569	561	553	545	538	531	524	517	510	504	497	491	485	479	474	468	463	457	452	447	442	437	432	428	423	419	414	410	406	402	398	394	390	387	383	380	376	373
0	0	0	653	643	634	624	615	606	597	589	581	573	565	557	550	542	535	528	521	515	508	502	496	490	484	478	473	467	462	457	451	446	442	437	432	428	423	419	415	411	407	403	399	395	392	388	385	381
0	0	0	668	658	648	638	629	619	610	602	594	585	577	569	561	554	546	539	532	526	519	513	506	500	494	488	483	477	472	466	461	456	451	446	441	437	432	428	424	419	415	411	407	404	400	397	393	390
0	0	0	683	672	662	652	642	633	624	615	606	598	589	581	573	565	558	551	543	537	530	523	517	511	504	498	493	487	481	476	471	466	460	456	451	446	441	437	432	428	424	420	416	412	409	405	401	398
0	0	0	698	687	676	666	656	647	637	628	619	610	601	593	585	577	569	562	555	548	541	534	527	521	515	509	503	497	491	486	480	475	470	465	460	455	450	446	441	437	433	429	425	421	417	413	410	406
0	0	0	0	0	0	0	671	660	650	641	632	622	614	605	597	589	581	573	566	559	552	545	538	532	525	519	513	507	501	496	490	485	480	474	469	464	460	455	450	446	442	437	433	429	426	422	418	415
0	0	0	0	0	0	0	685	674	664	654	644	635	626	617	609	601	592	585	577	570	562	556	549	542	536	529	523	517	511	505	500	495	489	484	479	474	469	464	459	455	450	446	442	438	434	430	427	423
0	0	0	0	0	0	0	699	688	678	667	657	648	638	629	621	612	604	596	588	581	573	566	560	553	546	540	533	527	521	515	510	504	499	493	488	483	478	473	468	464	459	455	451	447	443	439	435	432
0	0	0	0	0	0	0	714	703	692	681	670	660	651	642	633	624	616	608	600	592	585	577	570	563	557	550	544	537	531	525	520	514	508	503	498	492	487	482	477	473	468	464	459	455	451	447	444	440
0	0	0	0	0	0	0	729	717	706	695	683	673	663	654	645	636	627	619	611	603	596	588	581	574	567	560	554	548	541	535	530	524	518	512	507	502	497	491	487	482	477	472	468	464	460	456	452	449
0	0	0	0	0	0	0	0	0	0	0	696	686	676	666	657	648	639	631	622	614	607	599	592	585	578	571	564	558	551	545	540	534	528	522	517	511	506	501	496	491	486	481	477	473	468	464	461	457
0	0	0	0	0	0	0	0	0	0	0	709	699	688	679	669	660	651	642	634	626	618	610	603	595	588	581	575	568	562	555	550	544	538	532	526	521	515	510	505	500	495	490	486	481	477	473	469	466
0	0	0	0	0	0	0	0	0	0	0	722	711	701	691	681	672	663	654	645	637	629	621	614	606	599	592	585	578	572	565	560	553	547	541	536	530	524	519	514	509	504	499	494	490	486	482	478	474
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	694	684	675	666	657	648	640	632	625	617	610	602	595	589	582	575	570	563	557	551	545	539	534	528	523	518	513	508	503	499	494	490	486	482
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	706	696	687	677	668	660	651	643	635	628	620	613	606	599	592	585	580	573	567	561	555	549	543	537	532	527	522	517	512	507	503	499	495	491
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	718	708	698	689	680	671	663	654	646	639	631	623	616	609	602	595	589	583	576	570	564	558	552	547	541	536	531	526	521	516	512	507	503	499
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	692	683	674	666	657	649	642	634	627	619	612	606	599	593	586	580	574	568	562	556	550	545	540	534	530	525	520	516	512	508
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	703	694	685	677	668	660	652	645	637	630	623	616	609	602	596	589	583	577	571	565	560	554	549	543	538	534	529	524	520	516
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	715	706	697	688	679	671	663	655	647	640	633	626	619	612	605	599	593	586	580	574	569	563	558	552	547	542	537	533	529	525
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	727	717	708	699	690	682	674	666	658	650	643	636	628	622	615	608	602	596	589	583	578	572	566	561	556	551	546	541	537	533
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	701	692	684	676	668	660	653	646	638	631	624	618	611	605	599	593	587	581	575	570	565	560	555	550	545	541
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	712	703	695	687	678	671	663	656	647	640	634	627	620	614	608	602	596	590	584	579	573	568	563	558	554	549
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	688	681	673	666	657	650	643	636	630	623	617	611	605	599	593	588	582	577	572	567	562	558
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	699	691	683	676	666	659	652	646	639	632	626	620	614	608	602	596	591	586	580	575	570	566
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	709	701	693	686	675	668	661	655	647	641	635	629	623	617	611	605	600	594	589	584	579	574
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	684	677	670	664	656	650	644	638	631	625	620	614	608	603	597	592	587	582
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	692	686	679	673	665	659	653	647	640	634	628	623	617	611	606	600	595	590
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	673	667	661	655	649	643	637	631	625	620	614	609	603	598
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	682	676	670	664	657	651	646	640	634	628	622	617	611	606
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	666	660	654	648	642	636	631	625	619	613
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	674	668	663	657	651	645	639	633	627	621
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	654	648	642	636	630	624];

Power2 = [2000
3000
4000
5000
6000
7000
8000
9000
10000
11000
12000
13000
14000
15000
16000
17000
18000
19000
20000
21000
22000
23000
24000
25000
26000
27000
28000
29000
30000
31000
32000
33000
34000
35000
36000
37000
38000
39000
40000
41000
42000
43000
44000
45000
46000
47000
48000
49000
50000
51000
52000
53000
54000
55000
56000
57000
58000
59000
60000
61000
62000
63000
64000
65000
66000
67000
68000
69000
70000
71000
72000
73000
74000
75000
76000
77000
78000
79000
80000
81000
82000
83000
84000
85000
86000
87000
88000
89000
90000
91000
92000
93000
94000
95000
96000
97000
98000
99000
100000
101000
102000
103000
104000
105000
106000
107000];

Level2 = [8.5	9	9.5	10	10.5	11	11.5	12	12.5	13	13.5	14	14.5	15	15.5	16	16.5	17	17.5];

Flows2 = [38	37	37	36	35	36	34	32	31	31	30	29	28	28	27	27	26	26	25
49	49	48	48	44	45	42	40	39	38	38	36	35	34	34	33	32	32	31
61	60	60	59	53	54	51	48	47	46	45	43	42	40	40	39	38	37	37
73	72	71	70	63	64	60	56	55	54	53	51	49	47	46	45	44	43	43
84	84	83	81	72	73	69	65	63	62	60	58	56	54	53	51	50	49	49
96	95	94	93	82	83	78	73	71	69	68	65	63	61	60	58	56	56	55
108	107	106	104	91	92	86	81	79	77	76	73	70	67	66	64	63	62	61
119	118	117	115	100	102	95	89	87	85	84	80	77	74	73	70	69	68	67
131	130	128	127	110	111	104	98	95	93	91	88	84	81	80	77	75	74	73
143	141	140	138	119	121	113	106	104	101	99	95	92	88	87	83	82	80	79
154	153	151	149	129	131	122	115	112	109	107	103	99	95	93	90	88	87	85
166	164	163	161	139	140	131	123	120	117	115	110	106	102	100	97	95	93	92
178	176	174	172	148	150	140	131	128	125	123	118	113	109	107	103	101	99	98
190	187	186	183	158	160	149	140	136	133	130	125	120	116	114	110	108	106	104
201	199	197	194	169	170	159	149	145	141	138	133	128	123	121	116	114	112	110
213	210	209	206	179	181	168	157	153	149	146	140	135	130	128	123	120	118	116
225	222	220	217	190	191	178	166	162	158	154	148	142	137	134	130	127	125	123
243	230	222	220	201	202	188	175	170	166	162	155	149	144	141	136	133	131	129
262	259	237	226	213	214	198	185	179	174	170	163	157	151	148	143	140	137	135
274	271	258	239	225	225	208	194	188	183	178	171	164	158	155	149	146	143	141
286	282	280	276	238	238	219	204	197	191	187	179	171	165	162	156	153	150	147
297	294	291	287	248	251	231	214	207	200	195	187	179	172	169	163	159	156	153
309	306	303	298	258	261	243	224	216	209	204	195	186	179	176	169	166	162	160
321	317	314	310	267	271	253	235	226	219	212	203	194	186	183	176	172	169	166
332	329	326	321	277	281	262	246	236	228	221	211	202	194	190	183	179	175	172
344	340	337	332	287	290	271	254	247	238	231	220	210	201	197	190	185	181	178
356	352	348	344	297	300	280	263	256	248	240	229	218	209	205	197	192	188	184
367	363	360	355	307	310	289	271	265	258	250	238	227	217	212	204	199	194	191
379	375	371	366	317	320	299	280	273	266	261	247	236	225	220	211	205	201	197
391	386	383	378	327	330	308	289	281	274	269	257	245	233	228	218	212	207	204
403	398	394	389	337	340	317	297	290	282	276	266	254	242	236	226	219	214	210
421	409	406	400	348	351	327	306	298	290	284	273	262	251	244	233	227	221	227
440	421	417	411	358	361	336	315	306	299	292	281	270	260	253	241	234	237	233
452	449	429	423	369	372	346	324	315	307	300	288	277	267	262	249	247	243	239
464	461	440	434	380	383	356	332	323	315	308	296	284	274	269	259	254	249	245
475	472	474	436	391	393	365	341	332	323	316	303	291	281	276	266	260	255	251
487	483	484	480	402	404	375	351	341	332	324	311	298	288	282	272	267	262	257
499	495	494	490	414	416	386	360	349	340	332	319	306	295	289	279	273	268	264
510	506	505	500	425	427	396	369	358	348	340	326	313	302	296	286	280	274	270
522	517	515	509	435	439	406	378	367	357	348	334	320	309	303	292	286	281	276
534	528	526	519	445	450	417	388	376	365	357	342	328	316	310	299	293	287	282
546	540	536	528	455	460	428	398	385	374	365	350	335	323	317	305	299	293	288
557	551	546	538	465	470	439	407	394	383	373	357	343	330	324	312	305	299	294
569	562	557	548	475	480	448	417	403	391	381	365	350	337	331	319	312	306	301
581	574	567	557	485	490	457	428	413	400	390	373	358	344	338	325	318	312	307
592	585	578	567	495	500	466	437	422	409	398	381	365	351	345	332	325	318	313
604	596	588	576	506	511	476	446	432	418	407	389	373	358	352	339	331	325	319
616	608	598	586	516	521	485	455	442	428	416	398	380	366	359	346	338	331	325
627	619	609	596	527	531	495	463	451	437	425	406	388	373	366	352	344	337	332
639	630	619	605	537	542	504	472	459	447	434	414	396	380	373	359	351	344	338
651	641	630	615	548	552	514	481	468	456	443	423	404	388	380	366	357	350	344
663	653	640	624	559	563	524	490	476	464	452	431	412	395	387	373	364	356	350
674	664	650	634	570	574	533	499	485	472	461	440	420	403	395	380	370	363	356
686	675	661	644	581	585	543	508	494	481	470	449	428	410	402	387	377	369	363
698	687	671	653	592	596	553	517	502	489	478	458	437	418	409	394	384	375	369
709	698	682	663	603	607	563	526	511	497	486	467	445	426	417	401	390	382	375
721	709	692	672	615	618	573	535	520	506	494	474	454	434	424	408	397	388	382
733	721	702	682	627	629	584	544	528	514	502	482	462	442	432	415	404	395	388
744	732	713	692	639	641	594	553	537	522	510	490	470	450	440	422	411	401	394
0	0	0	701	651	652	604	563	546	531	518	497	477	458	448	429	418	408	401
0	0	0	711	663	664	615	572	555	539	527	505	484	466	456	436	425	415	407
0	0	0	0	675	676	625	582	564	548	535	513	492	474	464	444	432	421	414
0	0	0	0	688	688	636	592	573	557	543	521	499	481	472	451	439	428	420
0	0	0	0	701	701	647	601	582	565	551	528	506	488	479	459	446	435	427
0	0	0	0	714	713	658	611	591	574	560	536	514	495	486	466	453	442	442
0	0	0	0	727	726	669	621	601	583	568	544	521	502	493	474	460	455	448
0	0	0	0	741	739	681	631	610	592	576	552	529	509	500	482	471	462	454
0	0	0	0	755	752	692	641	619	600	585	560	536	516	507	488	477	468	460
0	0	0	0	769	765	704	652	629	609	593	568	544	523	513	495	484	474	466
0	0	0	0	0	779	716	662	638	618	602	576	552	530	520	502	490	481	472
0	0	0	0	0	793	728	673	648	628	611	584	559	538	528	508	497	487	479
0	0	0	0	0	807	740	683	658	637	619	592	567	545	535	515	503	493	485
0	0	0	0	0	821	753	694	668	646	628	601	575	552	542	522	510	499	491
0	0	0	0	0	836	765	705	678	655	637	609	582	559	549	529	516	506	497
0	0	0	0	0	851	778	716	688	665	646	617	590	567	556	535	523	512	503
0	0	0	0	0	866	791	728	699	675	655	626	598	574	563	542	529	518	510
0	0	0	0	0	882	804	739	709	684	664	634	606	581	570	549	536	525	516
0	0	0	0	0	898	818	751	719	694	673	643	614	589	577	556	543	531	522
0	0	0	0	0	914	831	763	730	704	683	651	622	596	585	563	549	537	528
0	0	0	0	0	931	845	775	741	714	692	660	630	604	592	570	556	544	535
0	0	0	0	0	0	860	787	752	724	701	669	638	611	599	576	562	550	541
0	0	0	0	0	0	874	799	763	734	711	677	647	619	607	583	569	557	547
0	0	0	0	0	0	889	812	774	745	721	686	655	627	614	590	576	563	553
0	0	0	0	0	0	904	825	786	755	731	695	663	635	622	597	582	570	560
0	0	0	0	0	0	919	838	798	766	740	705	672	642	629	604	589	576	566
0	0	0	0	0	0	0	851	809	777	750	714	681	650	637	612	596	582	572
0	0	0	0	0	0	0	865	821	788	761	723	689	658	644	619	603	589	579
0	0	0	0	0	0	0	879	834	799	771	732	698	666	652	626	609	596	585
0	0	0	0	0	0	0	893	846	810	781	742	707	675	660	633	616	602	592
0	0	0	0	0	0	0	0	859	822	792	752	716	683	668	640	623	609	598
0	0	0	0	0	0	0	0	871	834	802	761	725	691	676	647	630	615	604
0	0	0	0	0	0	0	0	884	845	813	771	734	700	684	655	637	622	611
0	0	0	0	0	0	0	0	898	857	824	781	743	708	692	662	644	629	617
0	0	0	0	0	0	0	0	911	870	835	791	753	717	700	670	651	635	624
0	0	0	0	0	0	0	0	0	882	847	802	762	726	708	677	658	642	630
0	0	0	0	0	0	0	0	0	895	858	812	772	734	716	684	665	649	637
0	0	0	0	0	0	0	0	0	908	870	823	782	743	724	692	672	656	643
0	0	0	0	0	0	0	0	0	921	882	833	792	753	733	700	680	663	650
0	0	0	0	0	0	0	0	0	0	894	844	802	762	741	707	687	670	0
0	0	0	0	0	0	0	0	0	0	906	855	812	771	750	715	694	677	0
0	0	0	0	0	0	0	0	0	0	918	867	822	781	759	723	702	0	0
0	0	0	0	0	0	0	0	0	0	931	878	833	790	768	731	709	0	0
0	0	0	0	0	0	0	0	0	0	0	890	844	800	777	739	0	0	0
0	0	0	0	0	0	0	0	0	0	0	901	855	810	786	0	0	0	0
0	0	0	0	0	0	0	0	0	0	0	913	866	820	795	0	0	0	0
0	0	0	0	0	0	0	0	0	0	0	925	877	830	804	0	0	0	0];

Power3 = [30000
35000
40000
45000
50000
55000
60000
65000
70000
75000
80000
85000
90000
95000
100000
105000
110000
115000
120000
125000
130000
135000
140000
145000
150000
155000
160000
165000
170000
175000
180000
185000
190000
195000
200000
205000
210000
215000
220000
225000
230000
235000
240000
245000
250000
255000
260000
265000
270000
275000
280000
285000
290000
295000
300000
305000
310000
315000
320000
325000
330000];

Level3 = [16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31];

Flows3 = [225	210	198	187	177	170	162	154	147	141	136	131	126	122	118	115
259	243	228	215	203	193	185	176	169	162	156	151	145	140	136	132
296	276	259	244	231	219	208	200	191	184	177	171	165	159	154	149
332	310	291	274	259	245	233	224	214	206	198	191	184	178	172	166
370	344	323	304	287	272	258	248	237	228	219	211	203	197	190	184
410	380	355	335	316	300	284	272	261	250	240	231	223	215	209	202
449	417	389	366	346	328	310	297	284	273	262	252	243	234	227	220
484	452	424	398	375	355	337	322	308	295	283	272	262	253	245	238
519	486	457	430	406	383	363	347	331	318	305	293	282	273	264	256
555	519	488	459	434	411	391	372	355	340	327	314	302	292	282	274
591	553	519	489	461	437	417	398	379	363	349	335	322	311	301	292
628	586	550	519	489	463	441	423	404	386	371	356	343	331	320	310
664	620	582	549	518	490	466	447	429	410	393	378	363	350	339	328
702	654	614	579	546	517	491	471	452	434	416	399	384	370	358	346
740	689	646	609	575	545	517	496	475	456	438	421	405	390	377	365
778	724	678	639	604	572	543	520	498	478	459	442	426	410	396	383
814	759	710	670	633	600	568	545	521	501	480	463	446	431	416	402
850	796	744	700	662	627	595	569	545	523	502	483	466	450	435	421
887	829	778	731	691	655	621	594	568	545	523	504	485	469	454	439
923	863	810	763	720	682	647	619	592	568	545	524	505	488	472	457
960	897	841	793	748	708	673	643	615	590	567	545	525	507	490	475
997	930	873	823	777	735	699	668	639	612	588	565	545	526	509	493
1034	964	905	853	805	762	725	693	663	635	610	586	565	545	527	511
1071	998	936	883	834	790	750	719	686	658	632	607	585	564	546	529
1109	1033	968	913	862	817	775	744	710	680	653	628	605	584	564	547
1148	1068	1001	943	891	845	801	768	734	703	675	649	625	603	583	565
1188	1103	1033	974	920	872	827	792	759	726	697	670	645	623	602	583
1229	1139	1066	1004	949	900	853	817	782	749	719	691	665	642	621	602
1272	1176	1099	1035	978	927	879	842	805	773	741	712	686	662	640	620
1316	1214	1132	1066	1007	955	905	866	829	795	764	734	706	681	658	638
1362	1252	1167	1097	1037	983	931	891	852	818	785	755	727	701	677	656
0	1292	1201	1129	1066	1011	957	916	876	840	807	776	747	721	697	674
0	1334	1237	1161	1096	1038	984	940	899	863	828	797	767	741	716	693
0	1377	1273	1193	1125	1066	1010	965	923	885	850	817	787	760	735	711
0	1422	1311	1226	1155	1094	1037	990	946	907	871	838	807	779	754	730
0	0	1349	1260	1186	1122	1064	1015	970	930	893	858	827	799	772	748
0	0	1389	1294	1217	1150	1090	1040	994	953	915	879	847	818	791	767
0	0	1431	1329	1248	1179	1117	1065	1018	975	936	900	867	837	809	785
0	0	1474	1365	1279	1207	1145	1091	1041	998	958	921	887	856	828	803
0	0	1519	1402	1312	1236	1172	1116	1065	1021	980	942	907	876	847	821
0	0	0	1440	1344	1266	1200	1142	1090	1043	1002	963	927	895	865	839
0	0	0	1479	1378	1295	1228	1168	1114	1066	1024	984	947	914	884	857
0	0	0	1520	1412	1326	1256	1194	1138	1089	1046	1005	967	934	903	875
0	0	0	0	1448	1357	1284	1220	1163	1113	1068	1026	988	953	922	893
0	0	0	0	1484	1388	1313	1246	1187	1136	1090	1047	1008	973	940	911
0	0	0	0	1522	1421	1343	1273	1212	1159	1112	1068	1028	992	959	930
0	0	0	0	0	1454	1372	1300	1237	1183	1134	1090	1049	1012	978	948
0	0	0	0	0	1489	1403	1328	1263	1207	1157	1111	1070	1032	997	966
0	0	0	0	0	1524	1433	1356	1289	1231	1179	1133	1090	1051	1016	984
0	0	0	0	0	1562	1465	1384	1315	1255	1202	1154	1111	1071	1035	1003
0	0	0	0	0	1600	1497	1413	1341	1279	1225	1176	1132	1091	1054	1021
0	0	0	0	0	1640	1530	1443	1368	1304	1248	1198	1152	1111	1073	1039
0	0	0	0	0	0	1564	1473	1395	1329	1271	1220	1173	1131	1093	1058
0	0	0	0	0	0	1598	1503	1423	1354	1295	1242	1194	1151	1112	1076
0	0	0	0	0	0	1633	1535	1451	1380	1318	1264	1215	1171	1131	1094
0	0	0	0	0	0	1670	1567	1479	1406	1342	1286	1237	1191	1150	1113
0	0	0	0	0	0	1707	1599	1509	1432	1367	1309	1258	1211	1170	1131
0	0	0	0	0	0	0	1633	1538	1459	1391	1332	1279	1231	1189	1150
0	0	0	0	0	0	0	1668	1569	1486	1416	1354	1301	1252	1208	1168
0	0	0	0	0	0	0	1703	1600	1513	1441	1377	1322	1272	1228	1187
0	0	0	0	0	0	0	0	1632	1542	1466	1400	1344	1293	1247	1206];

%% After data: Bonete:

for i = 1:length(Power1)
    for j = 10:length(Level1)
        if Flows1(i,j) ~= 0
            X1(i+(j-1)*length(Level1),:) = [Flows1(i,j),Level1(j)];
            Y1(i+(j-1)*length(Level1)) = Power1(i);
        end
    end
end

P1 = polyfitn(X1,Y1,{'x^2','x*y'});
Coeff1 = P1.Coefficients;
Coeff1(1) = Coeff1(1)/Coeff1(2);
Flows1(Flows1 == 0) = nan;
FLOW1 = [0:1:max(max(Flows1))];

figure;
for i = 10:length(Level1)
    hold on; grid minor;
    H1(i) = plot(Flows1(:,i),Power1,'o');
    J1(i) = plot(FLOW1,FLOW1*Level1(i)*Coeff1(2) + FLOW1.^2*Coeff1(1)*Coeff1(2));
    H1(i).Color = [1-i/length(Level1) i/length(Level1) 0];
    J1(i).Color = [1-i/length(Level1) i/length(Level1) 0];
end
xlim([0 FLOW1(end)]);
ylim([0 Power1(end)]);

%% Baygorria:

for i = 1:length(Power2)
    for j = 5:length(Level2)
        if Flows2(i,j) ~= 0
            X2(i+(j-1)*length(Level2),:) = [Flows2(i,j),Level2(j)];
            Y2(i+(j-1)*length(Level2)) = Power2(i);
        end
    end
end

P2 = polyfitn(X2,Y2,{'x^2','x*y'});
Coeff2 = P2.Coefficients;
Coeff2(1) = Coeff2(1)/Coeff2(2);
Flows2(Flows2 == 0) = nan;
FLOW2 = [0:1:max(max(Flows2))];

figure;
for i = 5:length(Level2)
    hold on; grid minor;
    H2(i) = plot(Flows2(:,i),Power2,'o');
    J2(i) = plot(FLOW2,FLOW2*Level2(i)*Coeff2(2) + FLOW2.^2*Coeff2(1)*Coeff2(2));
    H2(i).Color = [1-i/length(Level2) i/length(Level2) 0];
    J2(i).Color = [1-i/length(Level2) i/length(Level2) 0];
end
xlim([0 FLOW2(end)]);
ylim([0 Power2(end)]);

%% Palmar:

for i = 1:length(Power3)
    for j = 1:length(Level3)
        if Flows3(i,j) ~= 0
            X3(i+(j-1)*length(Level3),:) = [Flows3(i,j),Level3(j)];
            Y3(i+(j-1)*length(Level3)) = Power3(i);
        end
    end
end

P3 = polyfitn(X3,Y3,{'x^2','x*y'});
Coeff3 = P3.Coefficients;
Coeff3(1) = Coeff3(1)/Coeff3(2);
Flows3(Flows3 == 0) = nan;
FLOW3 = [0:1:max(max(Flows3))];

figure;
for i = 1:length(Level3)
    hold on; grid minor;
    H3(i) = plot(Flows3(:,i),Power3,'o');
    J3(i) = plot(FLOW3,FLOW3*Level3(i)*Coeff3(2) + FLOW3.^2*Coeff3(1)*Coeff3(2));
    H3(i).Color = [1-i/length(Level3) i/length(Level3) 0];
    J3(i).Color = [1-i/length(Level3) i/length(Level3) 0];
end
xlim([0 FLOW3(end)]);
ylim([0 Power3(end)]);

%% Next step:

Lev1 = [16:0.25:28];
Flo1 = [654 644 634 624 692 662 652 642 703 692 681 670 699 688 679 669 696 687 ...
    677 668 706 697 688 679 692 684 676 668 691 683 676 666 677 670 664 656 667 661 655 649 660 654 648 642 648 642 636 620 624];


Lev2 = [10:0.5:17.5];
Flo2 = [711 688 836 831 825 834 857 870 901 866 820 786 723 687 656 630];

Lev3 = [16:31];
Flo3 = [1362 1422 1519 1520 1522 1640 1707 1703 1632 1542 1466 1400 1344 1293 1247 1206];

figure;
plot(Lev1,Flo1,'o-');
hold on;
xlim([min(Lev1) max(Lev1)]);
figure;
plot(Lev2,Flo2,'o-');
hold on;
xlim([min(Lev2) max(Lev2)]);
figure;
plot(Lev3,Flo3,'o-');
hold on;
xlim([min(Lev3) max(Lev3)]);

Po1 = [90000 90000 90000 90000 98000 98000 98000 98000 108000 108000 108000 108000 114000 114000 114000 114000 ...
    120000 120000 120000 120000 126000 126000 126000 126000 132000 132000 132000 132000 138000 138000 138000 138000 ...
    142000 142000 142000 142000 146000 146000 146000 146000 150000 150000 150000 150000 152712 152712 152712 152712 152712];
Po2 = [62000 64000 75000 80000 85000 89000 94000 98000 105000 106000 106000 105000 ...
    102000 100000 98000 96000];
Po3 = [180000 200000 225000 240000 255000 285000 310000 325000 330000 330000 330000 330000 ...
    330000 330000 330000 330000];

figure;
plot(Lev1,Po1,'o-');
hold on;
xlim([min(Lev1) max(Lev1)]);
figure;
plot(Lev2,Po2,'o-');
hold on;
xlim([min(Lev2) max(Lev2)]);
figure;
plot(Lev3,Po3,'o-');
hold on;
xlim([min(Lev3) max(Lev3)]);

%% Approximations:

set(0,'CurrentFigure',4);
Pol11 = polyfit(Lev1,Flo1,2); % This!
Y11 = polyval(Pol11,Lev1);
plot(Lev1,Y11);

Pol2_1 = polyfix(Lev2(1:8),Flo2(1:8),Lev2(9),Flo2(9),1); % This!
Pol2_2 = polyfix(Lev2(10:end),Flo2(10:end),Lev2(9),Flo2(9),1); % This!
set(0,'CurrentFigure',5);
Y2_1 = polyval(Pol2_1,Lev2(1:9));
Y2_2 = polyval(Pol2_2,Lev2(9:end));
plot(Lev2(1:9),Y2_1,Lev2(9:end),Y2_2);
Pol22 = polyfit(Lev2,Flo2,2);
Y22 = polyval(Pol22,Lev2);
plot(Lev2,Y22);

Pol3_1 = polyfix(Lev3(1:7),Flo3(1:7),Lev3(8),Flo3(8),1); % This!
set(0,'CurrentFigure',6);
Y3_1 = polyval(Pol3_1,Lev3(1:8));
plot(Lev3(1:8),Y3_1,Lev3(8:end),Flo3(8:end));

SimPower1 = Coeff1(2).*Lev1.*Y11 + Coeff1(2)*Coeff1(1).*Y11.^2;
set(0,'CurrentFigure',7);
plot(Lev1,SimPower1,'*-');

SimPower2 = [Coeff2(2).*Lev2(1:9).*Y2_1 + Coeff2(2)*Coeff2(1).*Y2_1.^2,...
    Coeff2(2).*Lev2(10:end).*Y2_2(2:end) + Coeff2(2)*Coeff2(1).*Y2_2(2:end).^2];
SimPower22 = Coeff2(2).*Lev2.*Y22 + Coeff2(2)*Coeff2(1).*Y22.^2;
set(0,'CurrentFigure',8);
plot(Lev2,SimPower2,'*-');
plot(Lev2,SimPower22,'*-');

SimPower3 = [Coeff3(2).*Lev3(1:7).*Y3_1(1:7) + Coeff3(2)*Coeff3(1).*Y3_1(1:7).^2,...
    Coeff3(2).*Lev3(8:end).*Flo3(8:end) + Coeff3(2)*Coeff3(1).*Flo3(8:end).^2];
set(0,'CurrentFigure',9);
plot(Lev3,SimPower3,'*-');
grid minor;

%% New Way:

NewFlow3 = (-Lev3*Coeff3(2) + sqrt((Lev3*Coeff3(2)).^2+4*Coeff3(2)*Coeff3(1)*Po3))/(2*Coeff3(2)*Coeff3(1));
set(0,'CurrentFigure',6);
plot(Lev3,NewFlow3,'*-');

for h = 1:length(NewFlow3(9:end))
    aux(h) = NewFlow3(h+8)*(1+(h-1)/length(NewFlow3(9:end)));
end

Pol33_1 = polyfix(Lev3(1:7),NewFlow3(1:7),Lev3(8),NewFlow3(8),1);
Pol33_2 = polyfix(Lev3(9:end),NewFlow3(9:end)-[0 0 10 10 20 0 -5 0],Lev3(8),NewFlow3(8),2);
% Pol33_2 = polyfix(Lev3(9:end),NewFlow3(9:end),Lev3(8),NewFlow3(8),2);
% Pol33_2 = polyfix(Lev3(9:end),aux,Lev3(8),NewFlow3(8),2);
Y33_1 = polyval(Pol33_1,Lev3(1:7));
Y33_2 = polyval(Pol33_2,Lev3(8:end));
set(0,'CurrentFigure',6);
plot(Lev3,[Y33_1,Y33_2],'g');

set(0,'CurrentFigure',9);
SimPower33 = [Coeff3(2).*Lev3(1:7).*Y33_1(1:7) + Coeff3(2)*Coeff3(1).*Y33_1(1:7).^2,...
    Coeff3(2).*Lev3(8:end).*Y33_2 + Coeff3(2)*Coeff3(1).*Y33_2.^2];
plot(Lev3,SimPower33,'g*-');
grid minor;

%% Final:

MaxFlowCoeff{1} = Pol11;
MaxFlowCoeff{2} = {Pol2_1,Pol2_2,14};
MaxFlowCoeff{3} = {Pol33_1,Pol33_2,23};
MaxFlowCoeff{4} = {Coeff1(1),Coeff1(2),Coeff2(1),Coeff2(2),Coeff3(1),Coeff3(2)};
save('MaxFlowCoeff.mat','MaxFlowCoeff');