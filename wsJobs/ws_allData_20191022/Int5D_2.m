function [X] = Int5D_2(p,f)

    % p=[p1,p2,p3,p4] are the coordinates of the interpoled point.
    % f=[f1,f2,...,f16] are the evaluations in the corners of the square.
    
    [v,w,x,y,z] = ndgrid((0:1));
    [v1,w1,x1,y1,z1] = ndgrid([0,p(1),1],[0,p(2),1],[0,p(3),1],[0,p(4),1],[0,p(5),1]);
    ff = @(v,w,x,y,z) (v==0 & w==0 & x==0 & y==0 & z==0)*f(1) +...
        (v==1 & w==0 & x==0 & y==0 & z==0)*f(2) +...
        (v==0 & w==1 & x==0 & y==0 & z==0)*f(3) +...
        (v==1 & w==1 & x==0 & y==0 & z==0)*f(4) +...
        (v==0 & w==0 & x==1 & y==0 & z==0)*f(5) +...
        (v==1 & w==0 & x==1 & y==0 & z==0)*f(6) +...
        (v==0 & w==1 & x==1 & y==0 & z==0)*f(7) +...
        (v==1 & w==1 & x==1 & y==0 & z==0)*f(8) +...
        (v==0 & w==0 & x==0 & y==1 & z==0)*f(9) +...
        (v==1 & w==0 & x==0 & y==1 & z==0)*f(10) +...
        (v==0 & w==1 & x==0 & y==1 & z==0)*f(11) +...
        (v==1 & w==1 & x==0 & y==1 & z==0)*f(12) +...
        (v==0 & w==0 & x==1 & y==1 & z==0)*f(13) +...
        (v==1 & w==0 & x==1 & y==1 & z==0)*f(14) +...
        (v==0 & w==1 & x==1 & y==1 & z==0)*f(15) +...
        (v==1 & w==1 & x==1 & y==1 & z==0)*f(16) +...
        (v==0 & w==0 & x==0 & y==0 & z==1)*f(17) +...
        (v==1 & w==0 & x==0 & y==0 & z==1)*f(18) +...
        (v==0 & w==1 & x==0 & y==0 & z==1)*f(19) +...
        (v==1 & w==1 & x==0 & y==0 & z==1)*f(20) +...
        (v==0 & w==0 & x==1 & y==0 & z==1)*f(21) +...
        (v==1 & w==0 & x==1 & y==0 & z==1)*f(22) +...
        (v==0 & w==1 & x==1 & y==0 & z==1)*f(23) +...
        (v==1 & w==1 & x==1 & y==0 & z==1)*f(24) +...
        (v==0 & w==0 & x==0 & y==1 & z==1)*f(25) +...
        (v==1 & w==0 & x==0 & y==1 & z==1)*f(26) +...
        (v==0 & w==1 & x==0 & y==1 & z==1)*f(27) +...
        (v==1 & w==1 & x==0 & y==1 & z==1)*f(28) +...
        (v==0 & w==0 & x==1 & y==1 & z==1)*f(29) +...
        (v==1 & w==0 & x==1 & y==1 & z==1)*f(30) +...
        (v==0 & w==1 & x==1 & y==1 & z==1)*f(31) +...
        (v==1 & w==1 & x==1 & y==1 & z==1)*f(32);
    V = ff(v,w,x,y,z);
    Vq = interpn(v,w,x,y,z,V,v1,w1,x1,y1,z1,'makima');
    X = Vq(2,2,2,2,2);

end

% For testing:
% 
% for i=0:1000
% a(i+1)=Int4D_2([(i/1000)^3 (i/1000)^5 (i/1000)^2 (i/1000)^(1/2)],[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16])
% end
% plot(1:1001,a)